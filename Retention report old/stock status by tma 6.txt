select  vta.division_id,
        vta.division_name divisionName,
        vta.teritory_id,
        vta.teritory_name teritoryName,
        vta.zone_id,
        vta.zone_name zoneName,
        vta.route_id,
        ab.address_line1 clusterName,
        vta.route_name routeName,
        c.consumer_code outletCode,
        c.customer_name retailerName,
        NVL(c.trade_license_name,'N/A')outletName,
        NVL(c.mobile_no,'N/A') mobileNo,
        max(case when c.type=1 then 'RA'
             when c.type=2 then 'RB' 
             when c.type=3 then 'RC' 
             when c.type=4 then 'RD' 
             when c.type=5 then 'WA' 
             when c.type=6 then 'WB' 
             when c.type=7 then 'WC' 
             when c.type=8 then 'Floating'
             else 'others'
        end) Type,
        NVL(os.brand,'N/A')brand,
        os.stock_type stockStatus,
        NVL(sum(os.quantity),0) quantity
FROM    apptm.consumer c
JOIN    apptm.consumer_teritory ct ON c.id=ct.consumer_id
JOIN    apptm.v_teritory_all vta ON ct.teritory_id=vta.route_id
JOIN    apptm.consumer_address ca ON c.id=ca.consumer_id
JOIN    apptm.address_book ab ON ab.id=ca.address_id
JOIN    apptm.outlet_stock os ON c.id=os.outlet_id
where   to_char(os.target_date,'dd-mm-yyyy')=:targetDate
and     vta.teritory_id IN (:teritoryId)
and     vta.zone_id like '%' || :zoneId || '%'
and     vta.route_id like '%' || :routeId || '%'
group   by vta.division_id,vta.division_name,vta.teritory_id,vta.teritory_name,vta.zone_id,
        vta.zone_name,vta.route_id,vta.route_name,ab.address_line1,c.consumer_code,c.trade_license_name,c.customer_name,c.mobile_no,
        os.brand,os.stock_type
order   by vta.division_id,vta.teritory_id,vta.zone_id,vta.route_id,c.consumer_code